<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>WASM Bootstrapper</title>
    <style>
      .error {
        display: none;
        font-size: 2rem;
        background: red;
        color: white;
      }

      .error--active {
        display: block;
      }
    </style>
  </head>
  <body>
    <main>
      <div class="error"></div>
    </main>

    <script>
      'use strict';

      const showError = error => {
        const container = document.querySelector('.error');
        container.textContent = error.message;
        container.classList.add('error--active');
      };

      // const bytes = Uint8Array.from([0x00, 0x61, 0x73, 0x6d]);
      // const program = new ArrayBuffer(bytes.length);

      // for (let i = 0; i < bytes.length; i++) {
      //   program[i] = bytes[i];
      // }

      // console.log('*****', program);

      // WebAssembly.instantiate(program)
      //   .catch(showError);

      fetch('/bin.wasm')
        .then(res => res.arrayBuffer())
        .then(buffer => WebAssembly.instantiate(buffer))
        // TODO: run!
        .catch(showError);
    </script>
  </body>
</html>
